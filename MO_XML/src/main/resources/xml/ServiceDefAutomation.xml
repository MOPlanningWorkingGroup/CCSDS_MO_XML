<?xml version="1.0" encoding="UTF-8"?>
<mal:specification xmlns:com="http://www.ccsds.org/schema/COMSchema"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns:mal="http://www.ccsds.org/schema/ServiceSchema">
  <mal:area name="Automation" number="7" version="1"
            comment="This section details the automation services; the structures used by the services are detailed in section TBD. Both the services and structures are defined in terms of the MO MAL, which is defined in [TBD], so it is possible to deploy them over any supported protocol and message transport.&#xA;The services defined here are also specified in terms of the COM, which is defined in [TBD].&#xA;To aid comprehension, several tables are included for each service and operation definition. The table formats are briefly described in section TBD and are the same as those used for the specification of the MO COM services in [3]. &#xA;All service specifications in this document are part of the M&amp;C area, which has a short form number of '7'.">
    <mal:service xsi:type="com:ExtendedServiceType" name="Schedule" number="1"
                 comment="The schedule service has tree main functions: distribute schedules, control schedule execution, and report schedule status. The schedule service allows consumers to submit and patch schedules, control schedule execution and to subsequently monitor the status changes of the submitted and executing schedules.
				 &#xA;A schedule is submitted to the provider using the submitSchedule operation, the progress of which may optionally be monitored using the COM activity tracking pattern, which completes when the schedule has been delivered to the provider. The use of the COM activity tracking pattern is deployment specific. The usage pattern of the COM activity tracking is similar to the submitAction operation in the M&amp;C Action service.
				 &#xA;The submitSchedule operation takes the object instance identifier of the submitted schedule. This is required for the potential use of the COM activity tracking service, in order to populate the source fields of the activity tracking events. Coordination may be required between schedule service consumers to ensure the schedule object instance identifiers are unique. How this is done is outside the scope of this specification however a good approach is the use of a central COM archive as that can provide the unique instance identifiers.
				 &#xA;The nominal sequence of schedule distribution and status monitoring are shown in Figure:&#xA;&lt; TODO: insert sequence diag here &gt;
				 &#xA;The consumer is responsible for creating and archiving the schedule instance object and then using the submitSchedule operation to submit it to the schedule service provider.
				 &#xA;The schedule status consist of a set of fields. The fields are related to schedule life cycle states (submitted, started, etc). The schedule life cycle is not part of the specification.
				 &#xA;Consumer may subscribe to the monitoring of schedule instances. The notifications contain the schedule status objects.">
      <mal:documentation name="High Level Requirements" order="1">The schedule service shall provide:
&lt;ol&gt;
 &lt;li&gt;the capability for submitting schedules;&lt;/li&gt;
 &lt;li&gt;the capability for updating and removing already submitted schedules;&lt;/li&gt;
 &lt;li&gt;the capability for submitting schedule patches for making a batch of changes to the schedule;&lt;/li&gt;
 &lt;li&gt;the capability for getting a schedule status;&lt;/li&gt;
 &lt;li&gt;the capability for monitoring schedule status;&lt;/li&gt;
 &lt;li&gt;the capability for listing the numeric identifiers for the schedule definitions;&lt;/li&gt;
 &lt;li&gt;the capability for defining a new schedule definition;&lt;/li&gt;
 &lt;li&gt;the capability for updating an existing schedule definition;&lt;/li&gt;
 &lt;li&gt;the capability for removing an existing schedule definition.&lt;/li&gt;
 &lt;li&gt;the capability for controlling a schedule execution.&lt;/li&gt;
&lt;/ol&gt;
        The list of schedule types that are supported by the schedule service shall be declared when deploying that service.
        Each schedule submission shall include:
&lt;ol&gt;
 &lt;li&gt;the schedule definition numeric identifier;&lt;/li&gt;
 &lt;li&gt;the schedule instance numeric identifier;&lt;/li&gt;
 &lt;li&gt;the schedule instance object.&lt;/li&gt;
&lt;/ol&gt;
        The schedule request service may use the COM Activity Tracking service to report the delivery of a submitted schedules.
        The submitSchedule operation shall be used to submit a schedule.
      </mal:documentation>
<!--       <mal:documentation name="Functional Requirements" order="2"> -->
<!--       </mal:documentation> -->
      <mal:documentation name="TODO section" order="3">
      This section is not part of the specification, it lists the TODOs of this service specification.
		TODO: Add Functional Requirements, when the service operations, structures, errors, and COM usage has passed more reviews.      
		TODO: Produce UML diagrams that are pasted into generated Word documentation, similar to M&amp;C Action service, after the specification is considered more stable.
		TODO: Review the operation errors, when the operation signatures are considered stable.
		</mal:documentation>
      <mal:capabilitySet number="1" comment="Submit schedule instance">
	  <!-- submitSchedule -->
      <mal:submitIP name="submitSchedule" number="1" supportInReplay="false"
                      comment="The submitSchedule operation allows a consumer to submit a schedule to a provider.&#xA;TODO: The errors need to be specified for schedule fields.">
          <mal:messages>
            <mal:submit>
              <mal:field name="defInstId"
                         comment="The defInstId field of the submission shall contain a MAL::Long that is the object instance identifier of the ScheduleDefinition to be used.">
                <mal:type name="Long" area="MAL"/>
              </mal:field>
              <mal:field name="schInstId"
                         comment="The schInstId field of the submission shall contain a MAL::Long that is the object instance identifier of the ScheduleInstance to be used for the optional activity tracking events.">
                <mal:type name="Long" area="MAL"/>
              </mal:field>
              <mal:field name="schDetails"
                         comment="The schDetails part of the submission shall contain the information of the schedule instance.&#xA;The operation shall return once the schedule has been accepted by the provider.">
                <mal:type name="ScheduleInstanceDetails" service="Schedule" area="Automation"/>
              </mal:field>
            </mal:submit>
          </mal:messages>
          <mal:errors>
            <mal:errorRef comment="The argument list contains one or more invalid fields.">
              <mal:type name="INVALID" area="COM"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
            <mal:errorRef comment="Submitted schedule definition is unknown.">
              <mal:type name="UNKNOWN" area="MAL"/>
            </mal:errorRef>
          </mal:errors>
        </mal:submitIP>
      </mal:capabilitySet>
      <mal:capabilitySet number="2" comment="Update and remove schedule instance">
	  <!-- updateSchedule -->
      <mal:submitIP name="updateSchedule" number="2" supportInReplay="false"
                      comment="The updateSchedule operation allows a consumer to update a schedule by essentially replacing it. The difference between updateSchedule() and calling removeSchedule() + submitSchedule() is that in the latter case the ID of the schedule will change. The difference between updateSchedule() and patchSchedul() is that updateSchedule() will replace the whole schedule, while patchSchedule() will replace parts of a schedule. &#xA;TODO: The errors need to be specified for schedule fields.">
          <mal:messages>
            <mal:submit>
              <mal:field name="schInstId"
                         comment="The schInstId field of the submission shall contain a MAL::Long that is the object instance identifier of the ScheduleInstance that is going to be updated.">
                <mal:type name="Long" area="MAL"/>
              </mal:field>
              <mal:field name="schDetails"
                         comment="The schDetails part of the submission shall contain the information of the updated schedule instance. The schDetails instance will become the schedule instance on the provider referenced by schInstId.&#xA;The operation shall return once the schedule has been accepted by the provider.">
                <mal:type name="ScheduleInstanceDetails" service="Schedule" area="Automation"/>
              </mal:field>
            </mal:submit>
          </mal:messages>
          <mal:errors>
            <mal:errorRef comment="The argument list contains one or more invalid fields.">
              <mal:type name="INVALID" area="COM"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
          </mal:errors>
        </mal:submitIP>
	  <!-- removeSchedule -->
      <mal:submitIP name="removeSchedule" number="3" supportInReplay="false"
                      comment="The removeSchedule operation allows a consumer to remove an already submitted schedule. &#xA;TODO: The errors need to be specified.">
          <mal:messages>
            <mal:submit>
              <mal:field name="schInstId"
                         comment="The schInstId field of the submission shall contain a MAL::Long that is the object instance identifier of the ScheduleInstance that is going to be removed.">
                <mal:type name="Long" area="MAL"/>
              </mal:field>
            </mal:submit>
          </mal:messages>
        </mal:submitIP>
      </mal:capabilitySet>
      <mal:capabilitySet number="3" comment="Submit a fragment (patch) schedule updates for a merge onto target schedule">
	  <!-- patchSchedule -->
      <mal:submitIP name="patchSchedule" number="4" supportInReplay="false"
                      comment="The patchSchedule operation allows a consumer to submit a fragment (patch) of a schedule to be applied to the target schedule, which essentially merges an update into existing schedule. The patch consists of two structures: 1) the schedule instance containing the updates (ScheduleInstanceDetails), and 2) the associated patch operations (SchedulePatchOperations) to be applied to the fields of fragment schedule instance. The fields of SchedulePatchOperations correspond to the fields of ScheduleInstanceDetails.&#xA;Example: if a schedule item is to be added, then the schedule item is specified in ScheduleInstanceDetails::scheduleItems[0], if it is a first item. The corresponding SchedulePatchOperations::scheduleItems[0] contains the value of PatchOperations::ADD.&#xA;TODO: error specification.">
          <mal:messages>
			<mal:submit>
              <mal:field name="defInstId"
                         comment="The defInstId field of the submission shall contain a MAL::Long that is the object instance identifier of the ScheduleDefinition to be used. The definition applies both to the patch instance and the target schedule instance onto which the patch is to be merged.">
                <mal:type name="Long" area="MAL"/>
              </mal:field>
              <mal:field name="patchInstId"
                         comment="The patchInstId field of the submission shall contain a MAL::Long that is the object instance identifier of the patch ScheduleInstance to be used for the optional activity tracking events.">
                <mal:type name="Long" area="MAL"/>
              </mal:field>
              <mal:field name="patchInstDetails"
                         comment="The schInstDetails part of the submission shall contain the information of the schedule patch instance.&#xA;The operation shall return once the schedule patch has been accepted by the provider.">
                <mal:type name="ScheduleInstanceDetails" service="Schedule" area="Automation"/>
              </mal:field>
              <mal:field name="patchInstOperations"
                         comment="The patchInstOperations field of the submission shall contain the schedule patch operations (ADD, REMOVE, UPDATE) that correspond to the patchInstDetails.">
                <mal:type name="SchedulePatchOperations" service="Schedule" area="Automation"/>
              </mal:field>
              <mal:field name="targetSchInstId"
                         comment="The targetSchInstId field of the submission shall contain a MAL::Long that is the object instance identifier of the ScheduleInstance of the target schedule onto which the patch is going to be merged.">
                <mal:type name="Long" area="MAL"/>
              </mal:field>
            </mal:submit>
          </mal:messages>
          <mal:errors>
            <mal:errorRef comment="The argument list contains one or more invalid fields.">
              <mal:type name="INVALID" area="COM"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
            <mal:errorRef comment="Submitted schedule definition is unknown.">
              <mal:type name="UNKNOWN" area="MAL"/>
            </mal:errorRef>
          </mal:errors>
        </mal:submitIP>
      </mal:capabilitySet>
      <mal:capabilitySet number="4" comment="Get schedule status">
	  <!-- getScheduleStatus -->
        <mal:requestIP name="getScheduleStatus" number="5" supportInReplay="true"
                       comment="The getScheduleStatus operation allows a consumer to get a schedule status.">
          <mal:messages>
            <mal:request>
              <mal:field name="schIds"
                         comment="The schIds field shall contain a list of schedule ids to retrieve the schedule statuses for.&#xA;The request may contain the wildcard value of '*' to return statuses for all submitted schedules.">
                <mal:type list="true" name="Long" area="MAL"/>
              </mal:field>
            </mal:request>
            <mal:response>
              <mal:field name="schStatus"
                         comment="The operation shall return ScheduleStatusDetails objects. The order of the schedule status objects corresponds to the order of the submitted schedule instance ids. If a schedule instance id does not exist, then the corresponding schedule status object is null.">
                <mal:type list="true" name="ScheduleStatusDetails" service="Schedule" area="Automation"/>
              </mal:field>
            </mal:response>
          </mal:messages>
        </mal:requestIP>
      </mal:capabilitySet>
      <mal:capabilitySet number="5" comment="Monitor schedule status">
	  <!-- monitorSchedules -->
		<mal:pubsubIP name="monitorSchedules" number="6" supportInReplay="true"
                      comment="The monitorSchedules operation allows a consumer to subscribe for schedule status updates.&#xA;TBD: How to specify the schedule ids that we wish to monitor. The problem is similar to the MC Parameter service. There is a general monitorValue operation, that takes no arguments. A related enableGeneration operation specifies the instance ids or groups of instances for which the updates are generated. Alternatively, there is a generationEnabled field in ParameterDefinitionDetails.">
          <mal:messages>
            <mal:publishNotify>
              <mal:field name="objId"
                         comment="The MAL EntityKey.firstSubKey shall contain the schedule name.&#xA;The MAL EntityKey.secondSubKey shall contain the ScheduleDefinition object instance identifier.&#xA;The MAL EntityKey.thirdSubKey shall contain the ScheduleInstance object instance identifier.&#xA;The MAL EntityKey.fourthSubKey shall be NULL.&#xA;The timestamp of the ScheduleInstance update shall be taken from the publish message.&#xA;The publish message shall include the ObjectId of the source link of the update.&#xA;If no source link is needed then the ObjectId shall be replaced with a NULL.">
                <mal:type name="ObjectId" area="COM"/>
              </mal:field>
              <mal:field name="status"
                         comment="The second part of the publish message shall be the ScheduleInstance object value.">
                <mal:type name="ScheduleStatusDetails" service="Schedule" area="Automation"/>
              </mal:field>
            </mal:publishNotify>
          </mal:messages>
        </mal:pubsubIP>
      </mal:capabilitySet>
      <mal:capabilitySet number="6" comment="Control schedule">
	  <!-- start -->
      <mal:submitIP name="start" number="7" supportInReplay="false"
                      comment="The start operation allows a consumer to start executing a submitted or a paused schedule.">
          <mal:messages>
            <mal:submit>
              <mal:field name="schInstId"
                         comment="The schInstId field of the submission shall contain a MAL::Long that is the object instance identifier of the ScheduleInstance to be started.">
                <mal:type list="true" name="Long" area="MAL"/>
              </mal:field>
            </mal:submit>
          </mal:messages>
          <mal:errors>
            <mal:errorRef comment="There is no schedule associated with the schedule instance id">
              <mal:type name="INVALID" area="COM"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
            <mal:errorRef comment="The schedule has been terminated and may not be started.">
              <mal:type name="SCHEDULE_TERMINATED" service="Schedule" area="Automation"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
          </mal:errors>
        </mal:submitIP>
	  <!-- pause -->
      <mal:submitIP name="pause" number="8" supportInReplay="false"
                      comment="The pause operation allows a consumer to pause an executing schedule. Non-running schedules may not be paused and will return an error.">
          <mal:messages>
            <mal:submit>
              <mal:field name="schInstId"
                         comment="The schInstId field of the submission shall contain a MAL::Long that is the object instance identifier of the ScheduleInstance to be paused.">
                <mal:type list="true" name="Long" area="MAL"/>
              </mal:field>
            </mal:submit>
          </mal:messages>
          <mal:errors>
            <mal:errorRef comment="There is no schedule associated with the schedule instance id">
              <mal:type name="INVALID" area="COM"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
            <mal:errorRef comment="The schedule is not running.">
              <mal:type name="SCHEDULE_NOT_RUNNING" service="Schedule" area="Automation"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
            <mal:errorRef comment="The schedule has been terminated and may not be started.">
              <mal:type name="SCHEDULE_TERMINATED" service="Schedule" area="Automation"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
          </mal:errors>
        </mal:submitIP>
	  <!-- resume -->
      <mal:submitIP name="resume" number="9" supportInReplay="false"
                      comment="The resume operation allows a consumer to resume a paused schedule. Non-paused schedules may not be resumed and will return an error.">
          <mal:messages>
            <mal:submit>
              <mal:field name="schInstId"
                         comment="The schInstId field of the submission shall contain a MAL::Long that is the object instance identifier of the ScheduleInstance to be resumed.">
                <mal:type list="true" name="Long" area="MAL"/>
              </mal:field>
            </mal:submit>
          </mal:messages>
          <mal:errors>
            <mal:errorRef comment="There is no schedule associated with the schedule instance id">
              <mal:type name="INVALID" area="COM"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
            <mal:errorRef comment="The schedule is already running.">
              <mal:type name="SCHEDULE_RUNNING" service="Schedule" area="Automation"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
            <mal:errorRef comment="The schedule has been terminated and may not be started.">
              <mal:type name="SCHEDULE_TERMINATED" service="Schedule" area="Automation"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
          </mal:errors>
        </mal:submitIP>
	  <!-- terminate -->
      <mal:submitIP name="terminate" number="10" supportInReplay="false"
                      comment="The terminate operation allows a consumer to terminate a running or paused schedule. Non-running or terminated schedules will return an error.">
          <mal:messages>
            <mal:submit>
              <mal:field name="schInstId"
                         comment="The schInstId field of the submission shall contain a MAL::Long that is the object instance identifier of the ScheduleInstance to be terminated.">
                <mal:type list="true" name="Long" area="MAL"/>
              </mal:field>
            </mal:submit>
          </mal:messages>
          <mal:errors>
            <mal:errorRef comment="There is no schedule associated with the schedule instance id">
              <mal:type name="INVALID" area="COM"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
            <mal:errorRef comment="The schedule is not running.">
              <mal:type name="SCHEDULE_NOT_RUNNING" service="Schedule" area="Automation"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
          </mal:errors>
        </mal:submitIP>
      </mal:capabilitySet>
      <mal:capabilitySet number="7" comment="List schedule definition">
	  <!-- listDefinition -->
	          <mal:requestIP name="listDefinition" number="11" supportInReplay="true"
                       comment="The listDefinition operation allows a consumer to request the object instance identifiers of the ScheduleDefinition objects for the supported types of schedule of the provider. The operation is expected to be used in conjunction with the COM archive which holds the actual ScheduleDefinition objects.">
          <mal:messages>
            <mal:request>
              <mal:field name="prNames"
                         comment="The prNames field shall contain a list of schedule definition names to retrieve the ScheduleDefinition object instance identifiers for.&#xA;The request may contain the wildcard value of '*' to return all supported ScheduleDefinition objects.">
                <mal:type list="true" name="Identifier" area="MAL"/>
              </mal:field>
            </mal:request>
            <mal:response>
              <mal:field name="prDefInstIds"
                         comment="The response shall contain a list of matching ScheduleDefinition object instance ids.&#xA;The returned list shall maintain the same order as the submitted list unless the wildcard value was included in the request.">
                <mal:type list="true" name="Long" area="MAL"/>
              </mal:field>
            </mal:response>
          </mal:messages>
        </mal:requestIP>

      </mal:capabilitySet>
      <mal:capabilitySet number="8" comment="Add, update, remove schedule definition">
		<!-- addDefinition -->
        <mal:requestIP name="addDefinition" number="12" supportInReplay="false"
                       comment="The addDefinition operation allows a consumer to define one or more schedule types that do not currently exist. The new ScheduleDefinition object is expected to be stored in the COM archive by the provider of the schedule service.">
          <mal:messages>
            <mal:request>
              <mal:field name="prDefDetails"
                         comment="The prDefDetails field shall hold the list of definitions to be added.&#xA;The name field of the supplied ScheduleDefinitionDetails structures must not be NULL, the wildcard '*', or empty (an INVALID error shall be returned in this case).&#xA;The supplied name must be unique among all ScheduleDefinition objects for the domain of the provider otherwise a DUPLICATE error shall be raised.&#xA;If an error is raised then no new definitions shall be added as a result of this operation call.">
                <mal:type list="true" name="ScheduleDefinitionDetails" service="Schedule" area="Automation"/>
              </mal:field>
            </mal:request>
            <mal:response>
              <mal:field name="prDefInstIds"
                         comment="The response shall contain the list of object instance identifiers for the new definitions.&#xA;The returned list shall maintain the same order as the submitted definitions.">
                <mal:type list="true" name="Long" area="MAL"/>
              </mal:field>
            </mal:response>
          </mal:messages>
          <mal:errors>
            <mal:errorRef comment="One of the supplied schedule definitions contains an invalid schedule name.">
              <mal:type name="INVALID" area="COM"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
            <mal:errorRef comment="One or more of the schedule definitions being added has supplied a schedule name that is already in use in the domain.">
              <mal:type name="DUPLICATE" area="COM"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating request list.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
          </mal:errors>
        </mal:requestIP>
		<!-- updateDefinition -->
        <mal:submitIP name="updateDefinition" number="13" supportInReplay="false"
                      comment="The updateDefinition operation allows a consumer to modify a definition for one or more schedules without needing to delete the existing definition first.&#xA;This differs from deleting an existing definition and adding a new definition with the same schedule name in the fact that the object instance identifier of the definition being modified is not changed therefore the operation is only expected to be used for minor modifications such as descriptions.&#xA;The operation must not be used to change the name of an existing schedule definition, removal of the existing definition and adding the new definition must be used in this case.&#xA;The replacement definition should be stored in the COM archive by the service provider.">
          <mal:messages>
            <mal:submit>
              <mal:field name="prDefInstIds"
                         comment="The prDefInstIds field shall contain the list of object instance identifiers of the ScheduleDefinition objects to be updated.">
                <mal:type list="true" name="Long" area="MAL"/>
              </mal:field>
              <mal:field name="prDefDetails"
                         comment="The prDefDetails field shall contain the list of replacement details for the matched ScheduleDefinition objects.&#xA;The two lists shall be ordered the same.&#xA;The supplied object instance identifiers shall match existing definitions, an UNKNOWN error shall be raised if this is not the case.&#xA;Only the description or the unit fields of the arguments shall be permitted to be changed. Any other modification shall cause an INVALID error to be returned.&#xA;If an error is raised then no definitions shall be modified as a result of this operation call.">
                <mal:type list="true" name="ScheduleDefinitionDetails" service="Schedule" area="Automation"/>
              </mal:field>
            </mal:submit>
          </mal:messages>
          <mal:errors>
            <mal:errorRef comment="One of the supplied schedule definitions is trying to change its schedule definition name.">
              <mal:type name="INVALID" area="COM"/>
              <mal:extraInformation comment="The extra information field contains a list of the indexes of the erroneous values from the originating list supplied.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
            <mal:errorRef comment="One of the supplied ScheduleDefinition object instance identifiers is unknown.">
              <mal:type name="UNKNOWN" area="MAL"/>
              <mal:extraInformation comment="A list of the indexes of the error values shall be contained in the extra information field.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
          </mal:errors>
        </mal:submitIP>
		<!-- removeDefinition -->
        <mal:submitIP name="removeDefinition" number="14" supportInReplay="false"
                      comment="The removeDefinition operation allows a consumer to remove one or more definitions from the list of plannig request types supported by the schedule provider.&#xA;The operation does not remove the ScheduleDefinition object from the COM archive, merely removes the object from the provider. This permits active, and completed, ScheduleInstance objects to continue to reference the correct ScheduleDefinition object in the COM archive.">
          <mal:messages>
            <mal:submit>
              <mal:field name="prDefInstIds"
                         comment="The prDefInstIds field holds the list of ScheduleDefinition object instance identifiers of the definitions to be removed from the provider.&#xA;The wildcard value of '0' in the list of object instance identifiers shall be supported and matches all definitions of the provider.&#xA;If a provided definition object instance identifier does not include a wildcard and does not match an existing definition then this operation shall fail with an UNKNOWN error.&#xA;If a matched definition is still being used by an active schedule instance then this operation shall not fail because of this reason.&#xA;Removed definitions still exist in the COM archive but shall not be allowed to be referenced by new schedule instances.&#xA;If an error is raised then no definitions shall be removed as a result of this operation call.">
                <mal:type list="true" name="Long" area="MAL"/>
              </mal:field>
            </mal:submit>
          </mal:messages>
          <mal:errors>
            <mal:errorRef comment="One of the supplied ScheduleDefinition object instance identifiers is unknown.">
              <mal:type name="UNKNOWN" area="MAL"/>
              <mal:extraInformation comment="A list of the indexes of the error values shall be contained in the extra information field.">
                <mal:type list="true" name="UInteger" area="MAL"/>
              </mal:extraInformation>
            </mal:errorRef>
          </mal:errors>
        </mal:submitIP>
      </mal:capabilitySet>
      <mal:dataTypes>
		<!-- ScheduleDefinitionDetails -->
        <mal:composite name="ScheduleDefinitionDetails" shortFormPart="1"
                       comment="The ScheduleDefinitionDetails structure holds the definition information of a schedule.">
          <mal:extends>
            <mal:type name="Composite" area="MAL"/>
          </mal:extends>
          <mal:field name="name" canBeNull="false"
                     comment="The unique name of the schedule definition. Must not be empty or the wildcard value.">
            <mal:type name="Identifier" area="MAL"/>
          </mal:field>
          <mal:field name="description" canBeNull="false"
					comment="The description of the schedule definition.">
            <mal:type name="String" area="MAL"/>
          </mal:field>
          <mal:field name="argumentDefs" canBeNull="true"
                     comment="Definitions of schedule arguments.">
            <mal:type list="true" name="ArgumentDefinitionDetails" area="PlanningDataTypes"/>
          </mal:field>
          <mal:field name="eventTypes" canBeNull="false"
                     comment="Types of permitted events for this schedule. The event is a COM object. The events are not standardized as part of the planning request service.">
            <mal:type list="true" name="ObjectType" area="COM"/>
          </mal:field>
        </mal:composite>
		<!-- ScheduleInstanceDetails -->
        <mal:composite name="ScheduleInstanceDetails" shortFormPart="2"
                       comment="The ScheduleInstanceDetails structure holds the information required for an instance of a schedule such as the argument values to use.">
          <mal:extends>
            <mal:type name="Composite" area="MAL"/>
          </mal:extends>
          <mal:field name="name" canBeNull="false"
                     comment="The unique name of the schedule instance. Must not be empty or the wildcard value.">
            <mal:type name="Identifier" area="MAL"/>
          </mal:field>
          <mal:field name="description" canBeNull="false"
					comment="Comment for the schedule instance.">
            <mal:type name="String" area="MAL"/>
          </mal:field>
          <mal:field name="argumentDefNames" canBeNull="true"
                     comment="Argument definition names. ArgumentDefNames[i] corresponds to argumentValues[i]. Corresponds to ArgumentDefinitionDetails:name  in ScheduleDefinitionDetails:argumentDefs.">
            <mal:type list="true" name="Identifier" area="MAL"/>
          </mal:field>
          <mal:field name="argumentValues" canBeNull="true"
                     comment="The argument values. The order of arguments corresponds to the order of argument definitions if the schedule definition object.">
            <mal:type list="true" name="AttributeValue" area="PlanningDataTypes"/>
          </mal:field>
          <mal:field name="timingConstraints" canBeNull="true"
                     comment="Synchronization constraints for the schedule.">
            <mal:type list="true" name="TriggerDetails" area="PlanningDataTypes"/>
          </mal:field>
          <mal:field name="scheduleItems" canBeNull="true"
                     comment="The schedule items.">
            <mal:type list="true" name="ScheduleItemInstanceDetails" service="Schedule" area="Automation"/>
          </mal:field>
        </mal:composite>
		<!-- ScheduleItemInstanceDetails -->
        <mal:composite name="ScheduleItemInstanceDetails" shortFormPart="3"
                       comment="The ScheduleItemInstanceDetails structure holds the information required for an instance of a schedule item. The schedule item is a wrapper for an action, procedure or another schedule.">
          <mal:extends>
            <mal:type name="Composite" area="MAL"/>
          </mal:extends>
          <mal:field name="scheduleItemInstName" canBeNull="false"
                     comment="The unique name of a schedule item. Must not be empty or the wildcard value.">
            <mal:type name="Identifier" area="MAL"/>
          </mal:field>
          <mal:field name="scheduleInstName" canBeNull="false"
                     comment="The name of the schedule instance associated with this schedule item. Must not be empty or the wildcard value.">
            <mal:type name="Identifier" area="MAL"/>
          </mal:field>
          <mal:field name="argumentTypes" canBeNull="true"
                     comment="The argument types of argument values for the delegate item.">
            <mal:type list="true" name="ArgumentDefinitionDetails" area="PlanningDataTypes"/>
          </mal:field>
          <mal:field name="argumentValues" canBeNull="true"
                     comment="The argument values for the delegate item.">
            <mal:type list="true" name="AttributeValue" area="PlanningDataTypes"/>
          </mal:field>
          <mal:field name="timingConstraints" canBeNull="false"
                     comment="Synchronization constraints for the schedule item.">
            <mal:type list="true" name="TriggerDetails" area="PlanningDataTypes"/>
          </mal:field>
          <mal:field name="delegateItem" canBeNull="false"
                     comment="The type and instance of the associated activity or action this schedule item wraps.">
            <mal:type name="ObjectId" area="COM"/>
          </mal:field>
        </mal:composite>
		<!-- ScheduleStatusDetails -->
        <mal:composite name="ScheduleStatusDetails" shortFormPart="4"
                       comment="The ScheduleStatusDetails structure holds the information related to the schedule status. The schedule status consists of as set of fields, related to a typical schedule life cycle. The schedule life cycle is not part of the standard.">
          <mal:extends>
            <mal:type name="Composite" area="MAL"/>
          </mal:extends>
          <mal:field name="scheduleInstName" canBeNull="false"
                     comment="The name of the schedule instance associated with this schedule status. Must not be empty or the wildcard value.">
            <mal:type name="Identifier" area="MAL"/>
          </mal:field>
          <mal:field name="status" canBeNull="true"
                     comment="Contains the schedule status details objects, eg SUBMITTED, EXECUTE_STARTED.">
            <mal:type list="true" name="StatusRecord" area="PlanningDataTypes"/>
          </mal:field>
          <mal:field name="scheduleItemStatuses" canBeNull="false"
					comment="Contains the schedule item details objects, in the order of the schedule items in the schedule.">
            <mal:type list="true" name="ScheduleItemStatusDetails" service="Schedule" area="Automation"/>
          </mal:field>
        </mal:composite>
		<!-- ScheduleItemStatusDetails -->
        <mal:composite name="ScheduleItemStatusDetails" shortFormPart="5"
                       comment="The ScheduleItemStatusDetails structure holds the information related to the schedule item status. The schedule item status consists of as set of fields.">
          <mal:extends>
            <mal:type name="Composite" area="MAL"/>
          </mal:extends>
          <mal:field name="scheduleItemInstName" canBeNull="false"
                     comment="The name of the schedule item instance associated with this schedule item status. Must not be empty or the wildcard value.">
            <mal:type name="Identifier" area="MAL"/>
          </mal:field>
          <mal:field name="status" canBeNull="true"
                     comment="Contains the schedule item status details objects, eg EXECUTE_STARTED.">
            <mal:type list="true" name="StatusRecord" area="PlanningDataTypes"/>
          </mal:field>
        </mal:composite>
		<!-- SchedulePatchOperations -->
        <mal:composite name="SchedulePatchOperations" shortFormPart="7"
                       comment="The SchedulePatchOperations structure holds the patch operations to be applied to the associated schedule in order to merge the associated schedule. The associated schedule instance is specified in patchSchedule operation submission. The fields of SchedulePatchOperations correspond to the fields of ScheduleInstanceDetails. &#xA;Example: if a schedule item is to be added, then the schedule item is specified in ScheduleInstanceDetails::scheduleItems[0], if it is a first item. The corresponding SchedulePatchOperations::scheduleItems[0] contains the value of PatchOperations::ADD.">
          <mal:extends>
            <mal:type name="Composite" area="MAL"/>
          </mal:extends>
          <mal:field name="scheduleInstName" canBeNull="false"
                     comment="The name of the schedule instance associated with this schedule patch. Must not be empty or the wildcard value.">
            <mal:type name="Identifier" area="MAL"/>
          </mal:field>
          <mal:field name="argumentValues" canBeNull="true"
                     comment="The patch operations to be applied to the argument values of  the associated schedule.">
            <mal:type list="true" name="PatchOperation" service="Schedule" area="Automation"/>
          </mal:field>
          <mal:field name="timingConstraints" canBeNull="true"
                     comment="The patch operations to be applied to the timing constraints of the associated schedule.">
            <mal:type list="true" name="PatchOperation" service="Schedule" area="Automation"/>
          </mal:field>
          <mal:field name="scheduleItems" canBeNull="true"
                     comment="The schedule item patch operations correspond to the schedule items.">
            <mal:type list="true" name="ScheduleItemPatchOperations" service="Schedule" area="Automation"/>
          </mal:field>
        </mal:composite>
		<!-- ScheduleItemPatchOperations -->
        <mal:composite name="ScheduleItemPatchOperations" shortFormPart="8"
                       comment="The ScheduleItemPatchOperations structure holds the patch operations to be applied to the associated schedule item in order to merge the associated schedule item. See SchedulePatchOperations for more details.">
          <mal:extends>
            <mal:type name="Composite" area="MAL"/>
          </mal:extends>
          <mal:field name="scheduleItemInstName" canBeNull="false"
                     comment="The name of the schedule item instance associated with this schedule item patch. Must not be empty or the wildcard value.">
            <mal:type name="Identifier" area="MAL"/>
          </mal:field>
          <mal:field name="argumentTypes" canBeNull="true"
                     comment="The patch operations to be applied to the argument types of  the associated schedule item.">
            <mal:type list="true" name="PatchOperation" service="Schedule" area="Automation"/>
          </mal:field>
          <mal:field name="argumentValues" canBeNull="true"
                     comment="The patch operations to be applied to the argument values of  the associated schedule item.">
            <mal:type list="true" name="PatchOperation" service="Schedule" area="Automation"/>
          </mal:field>
          <mal:field name="timingConstraints" canBeNull="true"
                     comment="The patch operations to be applied to the timing constraints of the associated schedule item.">
            <mal:type list="true" name="PatchOperation" service="Schedule" area="Automation"/>
          </mal:field>
          <mal:field name="delegateItem" canBeNull="true"
                     comment="The patch operation to be applied to the delegate item of  the associated schedule item.">
            <mal:type name="PatchOperation" service="Schedule" area="Automation"/>
          </mal:field>
        </mal:composite>
		<!-- PatchOperation -->
		<mal:enumeration name="PatchOperation" shortFormPart="9"
						   comment="PatchOperation is an enumeration holding the types of updates in the merging a fragment schedule onto target schedule.">
			<mal:item value="ADD" nvalue="1"
					  comment="Add new item."/>
			<mal:item value="REMOVE" nvalue="2"
					  comment="Remove the item."/>
			<mal:item value="UPDATE" nvalue="2"
					  comment="Update the item by replacing it with the supplied item."/>
		  </mal:enumeration>
      </mal:dataTypes>
	<mal:errors>
      <mal:error name="SCHEDULE_RUNNING" number="70101" comment="Schedule is running"/>
      <mal:error name="SCHEDULE_NOT_RUNNING" number="70102" comment="Schedule is not running"/>
      <mal:error name="SCHEDULE_TERMINATED" number="70103" comment="Schedule has been terminate"/>
    </mal:errors>
      <com:features>
        <com:objects comment="The definitions of the schedules shall be represented as ScheduleDefinition COM objects.&#xA;The source link of the ScheduleDefinition object should be the object that caused it to be created, most likely a COM OperationActivity object or an operator login in the case of off-line editors being used.&#xA;Instances of a schedule that are submitted to a provider using the submitSchedule operation shall be represented as ScheduleInstance COM object.&#xA;The object instance identifier for an ScheduleInstance object shall be populated by the consumer.&#xA;The ScheduleInstance object shall use the related link to indicate which ScheduleDefinition object it uses.&#xA;Instances of a schedule that are submitted to a provider using the submitSchedule operation shall link to the submitSchdedule OperationActivity object using the source link.&#xA;The source link of the submitSchedule OperationActivity object should be the object that caused it to be created, most likely an operator login or automated procedure object.">
          <com:object name="ScheduleDefinition" number="1">
            <com:objectType>
              <mal:type name="ScheduleDefinitionDetails" service="Schedule" area="Automation"/>
            </com:objectType>
          </com:object>
          <com:object name="ScheduleInstance" number="2">
            <com:objectType>
              <mal:type name="ScheduleInstanceDetails" service="Schedule" area="MC"/>
            </com:objectType>
            <com:relatedObject>
              <com:objectType number="1" service="Schedule" area="Automation"/>
            </com:relatedObject>
          </com:object>
          <com:object name="ScheduleStatus" number="3">
            <com:objectType>
              <mal:type name="ScheduleStatusDetails" service="Schedule" area="Automation"/>
            </com:objectType>
            <com:relatedObject>
              <com:objectType number="2" service="Schedule" area="Automation"/>
            </com:relatedObject>
          </com:object>
        </com:objects>
		  <com:events comment="The use of the COM event service is not foreseen in the draft specification of the schedule service.">
        </com:events>
        <com:archiveUsage comment="ScheduleDefinition objects should be stored in the COM archive by the service provider.&#xA;When a schedule is sent with the submitSchedule or patchSchedule operation, the ScheduleInstance object should be stored in the COM archive by the consumer.&#xA;ScheduleStatus should be stored in the COM archive by the consumer."/>
        <com:activityUsage comment="The COM Activity service usage is optional.&#xA;The COM Activity service can be used to monitor the transfer of the submitSchedule and patchSchedule operation.&#xA;The COM Activity service can be used to monitor the transfer of ScheduleInstance objects."/>
      </com:features>
    </mal:service>
    <mal:service xsi:type="com:ExtendedServiceType" name="Procedure" number="2"
                 comment="TODO: The procedure service is a lower priority.">
    </mal:service>
	 <mal:dataTypes>
    </mal:dataTypes>
  </mal:area>
</mal:specification>